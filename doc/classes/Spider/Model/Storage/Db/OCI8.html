<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Spider::Model::Storage::Db::OCI8 [Spider documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Spider::Model::Storage::Db::OCI8
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../../../files/lib/spiderfw/model/storage/db/adapters/oci8_rb.html">lib/spiderfw/model/storage/db/adapters/oci8.rb</a>
            (<a href="http://github.com/me/spider/tree/master/lib/spiderfw/model/storage/db/adapters/oci8.rb">view online</a>)
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a href="DbStorage.html">Spider::Model::Storage::Db::DbStorage</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000192">base_types</a></li>
              <li><a href="#M000194">connection_alive?</a></li>
              <li><a href="#M000193">new_connection</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000225">column_attributes</a></li>
              <li><a href="#M000227">column_name</a></li>
              <li><a href="#M000224">column_type</a></li>
              <li><a href="#M000199">commit</a></li>
              <li><a href="#M000219">create_sequence</a></li>
              <li><a href="#M000222">describe_table</a></li>
              <li><a href="#M000195">disconnect</a></li>
              <li><a href="#M000204">execute</a></li>
              <li><a href="#M000206">execute_statement</a></li>
              <li><a href="#M000198">in_transaction?</a></li>
              <li><a href="#M000221">list_tables</a></li>
              <li><a href="#M000196">parse_url</a></li>
              <li><a href="#M000205">prepare</a></li>
              <li><a href="#M000201">prepare_value</a></li>
              <li><a href="#M000200">rollback</a></li>
              <li><a href="#M000230">schema_field_number_equal?</a></li>
              <li><a href="#M000229">schema_field_varchar2_equal?</a></li>
              <li><a href="#M000218">sequence_exists?</a></li>
              <li><a href="#M000228">sequence_name</a></li>
              <li><a href="#M000208">sequence_next</a></li>
              <li><a href="#M000217">sql_alter_field</a></li>
              <li><a href="#M000211">sql_condition_value</a></li>
              <li><a href="#M000216">sql_delete</a></li>
              <li><a href="#M000212">sql_insert</a></li>
              <li><a href="#M000213">sql_insert_values</a></li>
              <li><a href="#M000210">sql_limit</a></li>
              <li><a href="#M000209">sql_select</a></li>
              <li><a href="#M000214">sql_update</a></li>
              <li><a href="#M000215">sql_update_values</a></li>
              <li><a href="#M000197">start_transaction</a></li>
              <li><a href="#M000223">table_exists?</a></li>
              <li><a href="#M000226">table_name</a></li>
              <li><a href="#M000207">total_rows</a></li>
              <li><a href="#M000220">update_sequence</a></li>
              <li><a href="#M000202">value_for_condition</a></li>
              <li><a href="#M000203">value_to_mapper</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>reserved_kewords</td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'></td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>safe_conversions</td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='public-class method' id='method-M000192'>
                <a name='M000192'>      </a>
                <div class='synopsis'>
                  <span class='name'>base_types</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000192-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000192-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 20</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">base_types</span>&#x000A;            <span class="ruby-keyword kw">super</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-constant">Spider</span><span class="ruby-operator">::</span><span class="ruby-constant">DataTypes</span><span class="ruby-operator">::</span><span class="ruby-constant">Binary</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-class method' id='method-M000194'>
                <a name='M000194'>      </a>
                <div class='synopsis'>
                  <span class='name'>connection_alive?</span>
                  <span class='arguments'>(conn)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000194-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000194-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 30</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">connection_alive?</span>(<span class="ruby-identifier">conn</span>)&#x000A;            <span class="ruby-comment cmt"># TODO: move to ping method when ruby-oci8 2.x is stable</span>&#x000A;            <span class="ruby-keyword kw">begin</span>&#x000A;                <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">autocommit?</span>&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>&#x000A;            <span class="ruby-keyword kw">rescue</span>&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-class method' id='method-M000193'>
                <a name='M000193'>      </a>
                <div class='synopsis'>
                  <span class='name'>new_connection</span>
                  <span class='arguments'>(user, pass, dbname, role)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000193-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000193-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 24</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">new_connection</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">pass</span>, <span class="ruby-identifier">dbname</span>, <span class="ruby-identifier">role</span>)&#x000A;            <span class="ruby-identifier">conn</span> <span class="ruby-operator">||=</span> <span class="ruby-operator">::</span><span class="ruby-constant">OCI8</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">pass</span>, <span class="ruby-identifier">dbname</span>, <span class="ruby-identifier">role</span>)&#x000A;            <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">autocommit</span> = <span class="ruby-keyword kw">true</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">conn</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000225'>
                <a name='M000225'>      </a>
                <div class='synopsis'>
                  <span class='name'>column_attributes</span>
                  <span class='arguments'>(type, attributes)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000225-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000225-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 384</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">column_attributes</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">attributes</span>)&#x000A;             <span class="ruby-identifier">db_attributes</span> = <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">attributes</span>)&#x000A;             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">name</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'String'</span>&#x000A;                 <span class="ruby-identifier">db_attributes</span>[<span class="ruby-identifier">:length</span>] = <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">:length</span>] <span class="ruby-operator">||</span> <span class="ruby-value">255</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Fixnum'</span>&#x000A;                 <span class="ruby-identifier">db_attributes</span>[<span class="ruby-identifier">:precision</span>] = <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">:precision</span>] <span class="ruby-operator">||</span> <span class="ruby-value">38</span>&#x000A;                 <span class="ruby-identifier">db_attributes</span>[<span class="ruby-identifier">:length</span>] = <span class="ruby-keyword kw">nil</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Float'</span>&#x000A;                 <span class="ruby-comment cmt"># FIXME</span>&#x000A;                 <span class="ruby-identifier">db_attributes</span>[<span class="ruby-identifier">:precision</span>] = <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">:precision</span>] <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">:precision</span>])&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Spider::DataTypes::Bool'</span>&#x000A;                 <span class="ruby-identifier">db_attributes</span>[<span class="ruby-identifier">:precision</span>] = <span class="ruby-value">1</span>&#x000A;                 <span class="ruby-identifier">db_attributes</span>[<span class="ruby-identifier">:length</span>] = <span class="ruby-keyword kw">nil</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">db_attributes</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000227'>
                <a name='M000227'>      </a>
                <div class='synopsis'>
                  <span class='name'>column_name</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000227-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000227-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 407</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">column_name</span>(<span class="ruby-identifier">name</span>)&#x000A;             <span class="ruby-keyword kw">super</span>.<span class="ruby-identifier">upcase</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000224'>
                <a name='M000224'>      </a>
                <div class='synopsis'>
                  <span class='name'>column_type</span>
                  <span class='arguments'>(type, attributes)</span>
                </div>
                <div class='description'>
                  <p>
                  <a href="../Schema.html">Schema</a> methods
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000224-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000224-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 365</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">column_type</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">attributes</span>)&#x000A;             <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">name</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'String'</span>&#x000A;                 <span class="ruby-value str">'VARCHAR2'</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Spider::DataTypes::Text'</span>&#x000A;                 <span class="ruby-value str">'CLOB'</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Fixnum'</span>&#x000A;                 <span class="ruby-value str">'NUMBER'</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Float'</span>&#x000A;                 <span class="ruby-value str">'FLOAT'</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Date'</span>, <span class="ruby-value str">'DateTime'</span>&#x000A;                 <span class="ruby-value str">'DATE'</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Spider::DataTypes::Binary'</span>&#x000A;                 <span class="ruby-value str">'BLOB'</span>&#x000A;             <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Spider::DataTypes::Bool'</span>&#x000A;                 <span class="ruby-value str">'NUMBER'</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000199'>
                <a name='M000199'>      </a>
                <div class='synopsis'>
                  <span class='name'>commit</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000199-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000199-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 75</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">commit</span>&#x000A;            <span class="ruby-ivar">@conn</span>.<span class="ruby-identifier">commit</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@conn</span>&#x000A;            <span class="ruby-identifier">disconnect</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000219'>
                <a name='M000219'>      </a>
                <div class='synopsis'>
                  <span class='name'>create_sequence</span>
                  <span class='arguments'>(sequence_name, start=1, increment=1)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000219-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000219-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 315</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_sequence</span>(<span class="ruby-identifier">sequence_name</span>, <span class="ruby-identifier">start</span>=<span class="ruby-value">1</span>, <span class="ruby-identifier">increment</span>=<span class="ruby-value">1</span>)&#x000A;             <span class="ruby-identifier">execute</span>(<span class="ruby-node">&quot;create sequence #{sequence_name} start with #{start} increment by #{increment}&quot;</span>)&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000222'>
                <a name='M000222'>      </a>
                <div class='synopsis'>
                  <span class='name'>describe_table</span>
                  <span class='arguments'>(table)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000222-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000222-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 332</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">describe_table</span>(<span class="ruby-identifier">table</span>)&#x000A;             <span class="ruby-identifier">columns</span> = {}&#x000A;             <span class="ruby-identifier">connection</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">conn</span><span class="ruby-operator">|</span>&#x000A;                 <span class="ruby-identifier">t</span> = <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">describe_table</span>(<span class="ruby-identifier">table</span>)&#x000A;                 <span class="ruby-identifier">t</span>.<span class="ruby-identifier">columns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>&#x000A;                     <span class="ruby-identifier">col</span> = {&#x000A;                         <span class="ruby-identifier">:type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">data_type</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">upcase</span>,&#x000A;                         <span class="ruby-identifier">:length</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">data_size</span>,&#x000A;                         <span class="ruby-identifier">:precision</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">precision</span>,&#x000A;                         <span class="ruby-identifier">:scale</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">scale</span>,&#x000A;                         <span class="ruby-identifier">:null</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">nullable?</span>&#x000A;                     }&#x000A;                     <span class="ruby-identifier">col</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:length</span>) <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">col</span>[<span class="ruby-identifier">:precision</span>])&#x000A;                     <span class="ruby-identifier">columns</span>[<span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">col</span>&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-keyword kw">return</span> {<span class="ruby-identifier">:columns</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">columns</span>}&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000195'>
                <a name='M000195'>      </a>
                <div class='synopsis'>
                  <span class='name'>disconnect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000195-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000195-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 40</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disconnect</span>&#x000A;            <span class="ruby-keyword kw">begin</span>&#x000A;                <span class="ruby-ivar">@conn</span>.<span class="ruby-identifier">autocommit</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@conn</span>&#x000A;                <span class="ruby-keyword kw">super</span>&#x000A;            <span class="ruby-keyword kw">rescue</span>&#x000A;                <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">remove_connection</span>(<span class="ruby-ivar">@conn</span>, <span class="ruby-ivar">@connection_params</span>)&#x000A;                <span class="ruby-ivar">@conn</span> = <span class="ruby-keyword kw">nil</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000204'>
                <a name='M000204'>      </a>
                <div class='synopsis'>
                  <span class='name'>execute</span>
                  <span class='arguments'>(sql, *bind_vars) {|h| ...}</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000204-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000204-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 112</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">bind_vars</span>)&#x000A;             <span class="ruby-keyword kw">begin</span>&#x000A;                 <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">bind_vars</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">bind_vars</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)&#x000A;                     <span class="ruby-identifier">debug_vars</span> = <span class="ruby-identifier">bind_vars</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">var</span><span class="ruby-operator">|</span> <span class="ruby-identifier">var</span> = <span class="ruby-identifier">var</span>.<span class="ruby-identifier">to_s</span>; <span class="ruby-identifier">var</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">var</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">50</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">var</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">50</span>]<span class="ruby-operator">+</span><span class="ruby-node">&quot;...(#{var.length-50} chars more)&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">var</span>}&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-ivar">@last_executed</span> = [<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">bind_vars</span>]&#x000A;                 <span class="ruby-keyword kw">if</span> (<span class="ruby-constant">Spider</span>.<span class="ruby-identifier">conf</span>.<span class="ruby-identifier">get</span>(<span class="ruby-value str">'storage.db.replace_debug_vars'</span>))&#x000A;                     <span class="ruby-identifier">cnt</span> = <span class="ruby-value">-1</span>&#x000A;                     <span class="ruby-identifier">debug</span>(<span class="ruby-value str">&quot;oci8 executing: &quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">sql</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/:\d+/</span>){&#x000A;                         <span class="ruby-identifier">v</span> = <span class="ruby-identifier">bind_vars</span>[<span class="ruby-identifier">cnt</span>]&#x000A;                         <span class="ruby-identifier">dv</span> = <span class="ruby-identifier">debug_vars</span>[<span class="ruby-identifier">cnt</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>]&#x000A;                         <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">?</span> <span class="ruby-node">&quot;'#{dv}'&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">dv</span>&#x000A;                     })&#x000A;                 <span class="ruby-keyword kw">else</span>&#x000A;                     <span class="ruby-identifier">debug_vars_str</span> = <span class="ruby-identifier">debug_vars</span> <span class="ruby-value">? </span><span class="ruby-identifier">debug_vars</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>) <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>&#x000A;                     <span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;oci8 executing:\n#{sql}\n[#{debug_vars_str}]&quot;</span>)&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-ivar">@cursor</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">sql</span>)&#x000A;                 <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@cursor</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@cursor</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@cursor</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Fixnum</span>))&#x000A;                 <span class="ruby-identifier">bind_vars</span>.<span class="ruby-identifier">each_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>&#x000A;                     <span class="ruby-identifier">var</span> = <span class="ruby-identifier">bind_vars</span>[<span class="ruby-identifier">i</span>]&#x000A;                     <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">var</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">OCI8NilValue</span>))&#x000A;                         <span class="ruby-ivar">@cursor</span>.<span class="ruby-identifier">bind_param</span>(<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">var</span>.<span class="ruby-identifier">type</span>, <span class="ruby-value">0</span>)&#x000A;                     <span class="ruby-keyword kw">else</span>&#x000A;                         <span class="ruby-ivar">@cursor</span>.<span class="ruby-identifier">bind_param</span>(<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, <span class="ruby-identifier">var</span>)&#x000A;                     <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-identifier">res</span> = <span class="ruby-ivar">@cursor</span>.<span class="ruby-identifier">exec</span>&#x000A;                 <span class="ruby-identifier">have_result</span> = (<span class="ruby-ivar">@cursor</span>.<span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">OCI8</span><span class="ruby-operator">::</span><span class="ruby-constant">STMT_SELECT</span>)&#x000A;                 <span class="ruby-comment cmt"># @cursor = connection.exec(sql, *bind_vars)</span>&#x000A;                 <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">have_result</span>)&#x000A;                     <span class="ruby-identifier">result</span> = []&#x000A;                     <span class="ruby-keyword kw">while</span> (<span class="ruby-identifier">h</span> = <span class="ruby-ivar">@cursor</span>.<span class="ruby-identifier">fetch_hash</span>)&#x000A;                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>&#x000A;                              <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">h</span>&#x000A;                          <span class="ruby-keyword kw">else</span>&#x000A;                              <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">h</span>&#x000A;                          <span class="ruby-keyword kw">end</span>&#x000A;                     <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">have_result</span>)&#x000A;                     <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">block_given?</span>&#x000A;                         <span class="ruby-identifier">result</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">StorageResult</span>)&#x000A;                         <span class="ruby-ivar">@last_result</span> = <span class="ruby-identifier">result</span>&#x000A;                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>&#x000A;                     <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-keyword kw">else</span>&#x000A;                     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">exc</span>&#x000A;                 <span class="ruby-identifier">disconnect</span>&#x000A;                 <span class="ruby-identifier">raise</span> <span class="ruby-identifier">exc</span>&#x000A;             <span class="ruby-keyword kw">ensure</span>&#x000A;                 <span class="ruby-identifier">disconnect</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@conn</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">in_transaction?</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000206'>
                <a name='M000206'>      </a>
                <div class='synopsis'>
                  <span class='name'>execute_statement</span>
                  <span class='arguments'>(stmt, *bind_vars)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000206-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000206-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 175</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">execute_statement</span>(<span class="ruby-identifier">stmt</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">bind_vars</span>)&#x000A;             <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">exec</span>(<span class="ruby-identifier">bind_vars</span>)&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000198'>
                <a name='M000198'>      </a>
                <div class='synopsis'>
                  <span class='name'>in_transaction?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000198-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000198-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 71</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">in_transaction?</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@conn</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@conn</span>.<span class="ruby-identifier">autocommit?</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000221'>
                <a name='M000221'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_tables</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Methods to get information from the db #
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000221-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000221-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 328</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_tables</span>&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">execute</span>(<span class="ruby-value str">&quot;SELECT TABLE_NAME FROM user_tables ORDER BY table_name&quot;</span>).<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>[<span class="ruby-value str">'TABLE_NAME'</span>] }&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000196'>
                <a name='M000196'>      </a>
                <div class='synopsis'>
                  <span class='name'>parse_url</span>
                  <span class='arguments'>(url)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000196-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000196-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 50</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_url</span>(<span class="ruby-identifier">url</span>)&#x000A;            <span class="ruby-comment cmt"># db:oracle://&lt;username:password&gt;:connect_role@&lt;database&gt;</span>&#x000A;            <span class="ruby-comment cmt"># where database is</span>&#x000A;            <span class="ruby-comment cmt"># the net8 connect string or</span>&#x000A;            <span class="ruby-comment cmt"># for Oracle client 10g or later, //hostname_or_ip:port_no/oracle_sid</span>&#x000A;            <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">url</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/.+:\/\/(?:(.+):(.+)(?::(.+))?@)?(.+)/</span>)&#x000A;                <span class="ruby-ivar">@user</span> = <span class="ruby-identifier">$1</span>&#x000A;                <span class="ruby-ivar">@pass</span> = <span class="ruby-identifier">$2</span>&#x000A;                <span class="ruby-ivar">@role</span> = <span class="ruby-identifier">$3</span>&#x000A;                <span class="ruby-ivar">@dbname</span> = <span class="ruby-identifier">$4</span>&#x000A;            <span class="ruby-keyword kw">else</span>&#x000A;                <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;OCI8 url '#{url}' is invalid&quot;</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-ivar">@connection_params</span> = [<span class="ruby-ivar">@user</span>, <span class="ruby-ivar">@pass</span>, <span class="ruby-ivar">@dbname</span>, <span class="ruby-ivar">@role</span>]&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000205'>
                <a name='M000205'>      </a>
                <div class='synopsis'>
                  <span class='name'>prepare</span>
                  <span class='arguments'>(sql)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000205-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000205-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 170</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">sql</span>)&#x000A;             <span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;oci8 preparing: #{sql}&quot;</span>)&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@cursor</span> = <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">sql</span>)&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000201'>
                <a name='M000201'>      </a>
                <div class='synopsis'>
                  <span class='name'>prepare_value</span>
                  <span class='arguments'>(type, value)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000201-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000201-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 85</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">prepare_value</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">value</span>)&#x000A;            <span class="ruby-identifier">value</span> = <span class="ruby-keyword kw">super</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-constant">OCI8NilValue</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Spider</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span>.<span class="ruby-identifier">ruby_type</span>(<span class="ruby-identifier">type</span>)) <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>)&#x000A;            <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">name</span>&#x000A;            <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Spider::DataTypes::Binary'</span>&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-constant">OCI8</span><span class="ruby-operator">::</span><span class="ruby-constant">BLOB</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@conn</span>, <span class="ruby-identifier">value</span>)&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">value</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000200'>
                <a name='M000200'>      </a>
                <div class='synopsis'>
                  <span class='name'>rollback</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000200-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000200-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 80</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rollback</span>&#x000A;            <span class="ruby-ivar">@conn</span>.<span class="ruby-identifier">rollback</span>&#x000A;            <span class="ruby-identifier">disconnect</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000230'>
                <a name='M000230'>      </a>
                <div class='synopsis'>
                  <span class='name'>schema_field_number_equal?</span>
                  <span class='arguments'>(current, field)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000230-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000230-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 420</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">schema_field_number_equal?</span>(<span class="ruby-identifier">current</span>, <span class="ruby-identifier">field</span>)&#x000A;             <span class="ruby-comment cmt"># FIXME: where is the precision?</span>&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000229'>
                <a name='M000229'>      </a>
                <div class='synopsis'>
                  <span class='name'>schema_field_varchar2_equal?</span>
                  <span class='arguments'>(current, field)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000229-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000229-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 415</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">schema_field_varchar2_equal?</span>(<span class="ruby-identifier">current</span>, <span class="ruby-identifier">field</span>)&#x000A;             <span class="ruby-comment cmt"># FIXME: can't find the length</span>&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000218'>
                <a name='M000218'>      </a>
                <div class='synopsis'>
                  <span class='name'>sequence_exists?</span>
                  <span class='arguments'>(sequence_name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000218-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000218-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 309</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sequence_exists?</span>(<span class="ruby-identifier">sequence_name</span>)&#x000A;             <span class="ruby-identifier">check</span> = <span class="ruby-value str">&quot;select SEQUENCE_NAME from user_sequences where sequence_name = :1&quot;</span>&#x000A;             <span class="ruby-identifier">res</span> = <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">check</span>, <span class="ruby-identifier">sequence_name</span>)&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">?</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000228'>
                <a name='M000228'>      </a>
                <div class='synopsis'>
                  <span class='name'>sequence_name</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000228-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000228-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 411</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sequence_name</span>(<span class="ruby-identifier">name</span>)&#x000A;             <span class="ruby-identifier">shorten_identifier</span>(<span class="ruby-identifier">name</span>, <span class="ruby-value">30</span>).<span class="ruby-identifier">upcase</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000208'>
                <a name='M000208'>      </a>
                <div class='synopsis'>
                  <span class='name'>sequence_next</span>
                  <span class='arguments'>(sequence_name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000208-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000208-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 192</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sequence_next</span>(<span class="ruby-identifier">sequence_name</span>)&#x000A;             <span class="ruby-identifier">res</span> = <span class="ruby-identifier">execute</span>(<span class="ruby-node">&quot;SELECT #{sequence_name}.NEXTVAL AS NEXT FROM DUAL&quot;</span>)&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>[<span class="ruby-value">0</span>][<span class="ruby-value str">'NEXT'</span>].<span class="ruby-identifier">to_i</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000217'>
                <a name='M000217'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_alter_field</span>
                  <span class='arguments'>(table_name, name, type, attributes)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000217-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000217-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 305</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_alter_field</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">name</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">attributes</span>)&#x000A;             [<span class="ruby-node">&quot;ALTER TABLE #{table_name} MODIFY #{sql_table_field(name, type, attributes)}&quot;</span>]&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000211'>
                <a name='M000211'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_condition_value</span>
                  <span class='arguments'>(key, comp, value)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000211-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000211-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 260</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_condition_value</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">comp</span>, <span class="ruby-identifier">value</span>)&#x000A;             <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">comp</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'ilike'</span>)&#x000A;                 <span class="ruby-identifier">comp</span> = <span class="ruby-value str">'like'</span>&#x000A;                 <span class="ruby-identifier">key</span> = <span class="ruby-node">&quot;UPPER(#{key})&quot;</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>)&#x000A;                 <span class="ruby-identifier">comp</span> = <span class="ruby-identifier">comp</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'='</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;IS&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-value str">&quot;IS NOT&quot;</span>&#x000A;                 <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;#{key} #{comp} NULL&quot;</span>&#x000A;             <span class="ruby-keyword kw">else</span>&#x000A;                 <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;#{key} #{comp} :#{(@bind_cnt += 1)}&quot;</span>&#x000A;                 <span class="ruby-identifier">sql</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot; AND :#{(@bind_cnt += 1)}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">comp</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'between'</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">sql</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000216'>
                <a name='M000216'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_delete</span>
                  <span class='arguments'>(del, force=false)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000216-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000216-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 300</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_delete</span>(<span class="ruby-identifier">del</span>, <span class="ruby-identifier">force</span>=<span class="ruby-keyword kw">false</span>)&#x000A;             <span class="ruby-ivar">@bind_cnt</span> = <span class="ruby-value">0</span>&#x000A;             <span class="ruby-keyword kw">super</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000212'>
                <a name='M000212'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_insert</span>
                  <span class='arguments'>(insert)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000212-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000212-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 275</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_insert</span>(<span class="ruby-identifier">insert</span>)&#x000A;             <span class="ruby-ivar">@bind_cnt</span> = <span class="ruby-value">0</span>&#x000A;             <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">insert</span>[<span class="ruby-identifier">:values</span>].<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)&#x000A;             <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">insert</span>[<span class="ruby-identifier">:values</span>].<span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span>{<span class="ruby-node">&quot;:#{(@bind_cnt += 1)}&quot;</span>}&#x000A;             <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)&#x000A;             <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;INSERT INTO #{insert[:table]} (#{keys}) &quot;</span> <span class="ruby-operator">+</span>&#x000A;                   <span class="ruby-node">&quot;VALUES (#{vals})&quot;</span>&#x000A;             <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">insert</span>[<span class="ruby-identifier">:values</span>].<span class="ruby-identifier">values</span>]&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000213'>
                <a name='M000213'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_insert_values</span>
                  <span class='arguments'>(insert)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000213-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000213-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 285</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_insert_values</span>(<span class="ruby-identifier">insert</span>)&#x000A;             <span class="ruby-identifier">insert</span>[<span class="ruby-identifier">:values</span>].<span class="ruby-identifier">values</span>.<span class="ruby-identifier">map</span>{<span class="ruby-node">&quot;:#{(@bind_cnt += 1)}&quot;</span>}.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000210'>
                <a name='M000210'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_limit</span>
                  <span class='arguments'>(query)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000210-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000210-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 256</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_limit</span>(<span class="ruby-identifier">query</span>)&#x000A;             <span class="ruby-comment cmt"># already done in sql_condition</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000209'>
                <a name='M000209'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_select</span>
                  <span class='arguments'>(query)</span>
                </div>
                <div class='description'>
                  <p>
                  SQL methods #
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000209-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000209-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 203</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_select</span>(<span class="ruby-identifier">query</span>)&#x000A;             <span class="ruby-ivar">@bind_cnt</span> = <span class="ruby-value">0</span>&#x000A;             <span class="ruby-comment cmt"># Spider::Logger.debug(&quot;SQL SELECT:&quot;)</span>&#x000A;             <span class="ruby-comment cmt"># Spider::Logger.debug(query)</span>&#x000A;             <span class="ruby-identifier">bind_vars</span> = <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:bind_vars</span>] <span class="ruby-operator">||</span> []&#x000A;             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:limit</span>] <span class="ruby-comment cmt"># Oracle is so braindead</span>&#x000A;                 <span class="ruby-identifier">replaced_fields</span> = {}&#x000A;                 <span class="ruby-identifier">replace_cnt</span> = <span class="ruby-value">0</span>&#x000A;                 <span class="ruby-comment cmt"># add first field to order if none is found; order is needed for limit</span>&#x000A;                 <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:order</span>] <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">query</span>[<span class="ruby-identifier">:keys</span>][<span class="ruby-value">0</span>], <span class="ruby-value str">'desc'</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:order</span>].<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>&#x000A;                 <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:order</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span>&#x000A;                     <span class="ruby-identifier">field</span>, <span class="ruby-identifier">direction</span> = <span class="ruby-identifier">o</span>&#x000A;                     <span class="ruby-comment cmt"># i = query[:keys].index(field)</span>&#x000A;                     <span class="ruby-comment cmt">#   unless i</span>&#x000A;                     <span class="ruby-comment cmt">#       query[:keys].push(field)</span>&#x000A;                     <span class="ruby-comment cmt">#       i = query[:keys].length &lt; 1</span>&#x000A;                     <span class="ruby-comment cmt">#   end</span>&#x000A;                     <span class="ruby-identifier">transformed</span> = <span class="ruby-node">&quot;O#{replace_cnt += 1}&quot;</span>&#x000A;                     <span class="ruby-identifier">replaced_fields</span>[<span class="ruby-identifier">field</span>] = <span class="ruby-identifier">transformed</span>&#x000A;                     <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:keys</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{field} AS #{transformed}&quot;</span>&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-identifier">keys</span> = <span class="ruby-identifier">sql_keys</span>(<span class="ruby-identifier">query</span>)&#x000A;             <span class="ruby-identifier">order</span> = <span class="ruby-identifier">sql_order</span>(<span class="ruby-identifier">query</span>)&#x000A;             <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">query</span>[<span class="ruby-identifier">:limit</span>])&#x000A;                 <span class="ruby-identifier">keys</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;, row_number() over (order by #{order}) oci8_row_num&quot;</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-identifier">tables_sql</span>, <span class="ruby-identifier">tables_values</span> = <span class="ruby-identifier">sql_tables</span>(<span class="ruby-identifier">query</span>)&#x000A;             <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;SELECT #{keys} FROM #{tables_sql} &quot;</span>&#x000A;             <span class="ruby-identifier">bind_vars</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">tables_values</span>&#x000A;             <span class="ruby-identifier">where</span>, <span class="ruby-identifier">vals</span> = <span class="ruby-identifier">sql_condition</span>(<span class="ruby-identifier">query</span>)&#x000A;             <span class="ruby-identifier">bind_vars</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">vals</span>&#x000A;             <span class="ruby-identifier">sql</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;WHERE #{where} &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">where</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">where</span>.<span class="ruby-identifier">empty?</span>&#x000A;             <span class="ruby-identifier">order</span> = <span class="ruby-identifier">sql_order</span>(<span class="ruby-identifier">query</span>)&#x000A;             <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">query</span>[<span class="ruby-identifier">:limit</span>])&#x000A;                 <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">query</span>[<span class="ruby-identifier">:offset</span>])&#x000A;                     <span class="ruby-identifier">limit</span> = <span class="ruby-node">&quot;oci8_row_num between :#{@bind_cnt+=1} and :#{@bind_cnt+=1}&quot;</span>&#x000A;                     <span class="ruby-identifier">bind_vars</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:offset</span>] <span class="ruby-operator">+</span> <span class="ruby-value">1</span>&#x000A;                     <span class="ruby-identifier">bind_vars</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:offset</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:limit</span>]&#x000A;                 <span class="ruby-keyword kw">else</span>&#x000A;                     <span class="ruby-identifier">limit</span> = <span class="ruby-node">&quot;oci8_row_num &lt; :#{@bind_cnt+=1}&quot;</span>&#x000A;                     <span class="ruby-identifier">bind_vars</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">query</span>[<span class="ruby-identifier">:limit</span>] <span class="ruby-operator">+</span> <span class="ruby-value">1</span>&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-identifier">replaced_fields</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span>, <span class="ruby-identifier">repl</span><span class="ruby-operator">|</span>&#x000A;                     <span class="ruby-identifier">order</span> = <span class="ruby-identifier">order</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">repl</span>)&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-identifier">sql</span> = <span class="ruby-node">&quot;SELECT * FROM (#{sql}) WHERE #{limit} order by #{order}&quot;</span>&#x000A;             <span class="ruby-keyword kw">else</span>&#x000A;                 <span class="ruby-identifier">sql</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;ORDER BY #{order} &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">order</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">order</span>.<span class="ruby-identifier">empty?</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">sql</span>, <span class="ruby-identifier">bind_vars</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000214'>
                <a name='M000214'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_update</span>
                  <span class='arguments'>(query)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000214-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000214-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 289</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_update</span>(<span class="ruby-identifier">query</span>)&#x000A;             <span class="ruby-ivar">@bind_cnt</span> = <span class="ruby-value">0</span>&#x000A;             <span class="ruby-keyword kw">super</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000215'>
                <a name='M000215'>      </a>
                <div class='synopsis'>
                  <span class='name'>sql_update_values</span>
                  <span class='arguments'>(update)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000215-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000215-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 294</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sql_update_values</span>(<span class="ruby-identifier">update</span>)&#x000A;             <span class="ruby-identifier">update</span>[<span class="ruby-identifier">:values</span>].<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> &#x000A;                 <span class="ruby-node">&quot;#{k} = :#{(@bind_cnt += 1)}&quot;</span>&#x000A;             }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000197'>
                <a name='M000197'>      </a>
                <div class='synopsis'>
                  <span class='name'>start_transaction</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000197-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000197-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 67</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">start_transaction</span>&#x000A;            <span class="ruby-identifier">connection</span>.<span class="ruby-identifier">autocommit</span> = <span class="ruby-keyword kw">false</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000223'>
                <a name='M000223'>      </a>
                <div class='synopsis'>
                  <span class='name'>table_exists?</span>
                  <span class='arguments'>(table)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000223-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000223-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 351</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">table</span>)&#x000A;             <span class="ruby-keyword kw">begin</span>&#x000A;                 <span class="ruby-identifier">connection</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>&#x000A;                     <span class="ruby-identifier">c</span>.<span class="ruby-identifier">describe_table</span>(<span class="ruby-identifier">table</span>)&#x000A;                 <span class="ruby-keyword kw">end</span>&#x000A;                 <span class="ruby-constant">Spider</span>.<span class="ruby-identifier">logger</span>.<span class="ruby-identifier">debug</span>(<span class="ruby-node">&quot;TABLE EXISTS #{table}&quot;</span>)&#x000A;                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>&#x000A;             <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">OCIError</span>&#x000A;                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000226'>
                <a name='M000226'>      </a>
                <div class='synopsis'>
                  <span class='name'>table_name</span>
                  <span class='arguments'>(name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000226-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000226-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 402</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">table_name</span>(<span class="ruby-identifier">name</span>)&#x000A;             <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">'::'</span>, <span class="ruby-value str">'_'</span>)&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">shorten_identifier</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-value">30</span>).<span class="ruby-identifier">upcase</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000207'>
                <a name='M000207'>      </a>
                <div class='synopsis'>
                  <span class='name'>total_rows</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000207-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000207-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 179</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">total_rows</span>&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@last_executed</span>&#x000A;             <span class="ruby-identifier">q</span> = <span class="ruby-ivar">@last_query</span>.<span class="ruby-identifier">clone</span>&#x000A;             <span class="ruby-keyword kw">unless</span> (<span class="ruby-identifier">q</span>[<span class="ruby-identifier">:offset</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">q</span>[<span class="ruby-identifier">:limit</span>])&#x000A;                 <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@last_result</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@last_result</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>&#x000A;             <span class="ruby-keyword kw">end</span>&#x000A;             <span class="ruby-identifier">q</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:offset</span>); <span class="ruby-identifier">q</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">:limit</span>)&#x000A;             <span class="ruby-identifier">sql</span>, <span class="ruby-identifier">vars</span> = <span class="ruby-identifier">sql_select</span>(<span class="ruby-identifier">q</span>)&#x000A;             <span class="ruby-identifier">res</span> = <span class="ruby-identifier">execute</span>(<span class="ruby-node">&quot;SELECT COUNT(*) AS N FROM (#{sql})&quot;</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">vars</span>)&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">res</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">res</span>[<span class="ruby-value">0</span>]&#x000A;             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>[<span class="ruby-value">0</span>][<span class="ruby-value str">'N'</span>].<span class="ruby-identifier">to_i</span>&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000220'>
                <a name='M000220'>      </a>
                <div class='synopsis'>
                  <span class='name'>update_sequence</span>
                  <span class='arguments'>(name, val)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000220-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000220-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 319</span>&#x000A;         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_sequence</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">val</span>)&#x000A;             <span class="ruby-identifier">execute</span>(<span class="ruby-node">&quot;drop sequence #{name}&quot;</span>)&#x000A;             <span class="ruby-identifier">create_sequence</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">val</span>)&#x000A;         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000202'>
                <a name='M000202'>      </a>
                <div class='synopsis'>
                  <span class='name'>value_for_condition</span>
                  <span class='arguments'>(type, value)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000202-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000202-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 95</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">value_for_condition</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">value</span>)&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">value</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>&#x000A;            <span class="ruby-keyword kw">super</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000203'>
                <a name='M000203'>      </a>
                <div class='synopsis'>
                  <span class='name'>value_to_mapper</span>
                  <span class='arguments'>(type, value)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000203-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000203-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/storage/db/adapters/oci8.rb, line 100</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">value_to_mapper</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">value</span>)&#x000A;            <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">type</span>.<span class="ruby-identifier">name</span>&#x000A;            <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Date'</span>, <span class="ruby-value str">'DateTime'</span>&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">value</span>&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_datetime</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-constant">DateTime</span>&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_date</span> <span class="ruby-comment cmt"># FIXME: check what is returned, here we espect an OCI8::Date</span>&#x000A;            <span class="ruby-keyword kw">when</span> <span class="ruby-value str">'Spider::DataTypes::Text'</span>&#x000A;                <span class="ruby-identifier">value</span> =  <span class="ruby-identifier">value</span> <span class="ruby-value">? </span><span class="ruby-identifier">value</span>.<span class="ruby-identifier">read</span> <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">value</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
