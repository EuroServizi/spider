<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Spider::Model::QuerySet [Spider documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Spider::Model::QuerySet
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../files/lib/spiderfw/model/query_set_rb.html">lib/spiderfw/model/query_set.rb</a>
            (<a href="http://github.com/me/spider/tree/master/lib/spiderfw/model/query_set.rb">view online</a>)
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            The <a href="QuerySet.html">QuerySet</a> expresses represents a <a
            href="Query.html">Query</a> applied on a <a href="../Model.html">Model</a>.
            It includes Enumerable, and can be accessed as an Array; but, the <a
            href="QuerySet.html">QuerySet</a> is lazy, and the actual data will be
            fetched only when actually requested, or when a <a
            href="QuerySet.html#M000472">load</a> is issued. How much data is fetched
            and kept in memory can be controlled by setting the fetch_window and the
            keep_window.
            </p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000442">new</a></li>
              <li><a href="#M000441">static</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000457">+</a></li>
              <li><a href="#M000451">&lt;&lt;</a></li>
              <li><a href="#M000452">[]</a></li>
              <li><a href="#M000453">[]=</a></li>
              <li><a href="#M000490">all_children</a></li>
              <li><a href="#M000445">autoload</a></li>
              <li><a href="#M000446">autoload=</a></li>
              <li><a href="#M000447">autoload?</a></li>
              <li><a href="#M000498">clone</a></li>
              <li><a href="#M000461">current_length</a></li>
              <li><a href="#M000484">cut</a></li>
              <li><a href="#M000456">delete_at</a></li>
              <li><a href="#M000465">each</a></li>
              <li><a href="#M000464">each_current</a></li>
              <li><a href="#M000467">each_current_index</a></li>
              <li><a href="#M000466">each_index</a></li>
              <li><a href="#M000491">element_loaded</a></li>
              <li><a href="#M000492">element_loaded?</a></li>
              <li><a href="#M000462">empty?</a></li>
              <li><a href="#M000469">find</a></li>
              <li><a href="#M000444">fixed</a></li>
              <li><a href="#M000459">has_more?</a></li>
              <li><a href="#M000493">identity_mapper</a></li>
              <li><a href="#M000494">identity_mapper=</a></li>
              <li><a href="#M000463">index_by</a></li>
              <li><a href="#M000478">insert</a></li>
              <li><a href="#M000482">inspect</a></li>
              <li><a href="#M000481">instantiate_object</a></li>
              <li><a href="#M000455">last</a></li>
              <li><a href="#M000458">length</a></li>
              <li><a href="#M000496">limit</a></li>
              <li><a href="#M000472">load</a></li>
              <li><a href="#M000474">load_next</a></li>
              <li><a href="#M000473">load_to_index</a></li>
              <li><a href="#M000476">loadable?</a></li>
              <li><a href="#M000475">loaded?</a></li>
              <li><a href="#M000443">mapper</a></li>
              <li><a href="#M000468">merge</a></li>
              <li><a href="#M000489">method_missing</a></li>
              <li><a href="#M000449">no_autoload</a></li>
              <li><a href="#M000497">offset</a></li>
              <li><a href="#M000470">order_by</a></li>
              <li><a href="#M000477">save</a></li>
              <li><a href="#M000480">save_all</a></li>
              <li><a href="#M000471">set</a></li>
              <li><a href="#M000450">set_data</a></li>
              <li><a href="#M000448">set_parent</a></li>
              <li><a href="#M000486">table</a></li>
              <li><a href="#M000487">to_flat_array</a></li>
              <li><a href="#M000485">to_hash_array</a></li>
              <li><a href="#M000483">to_json</a></li>
              <li><a href="#M000488">to_s</a></li>
              <li><a href="#M000460">total_rows</a></li>
              <li><a href="#M000479">update</a></li>
              <li><a href="#M000454">update_loaded_elements</a></li>
              <li><a href="#M000495">where</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li>Enumerable</li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>_parent</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <a href="BaseModel.html">BaseModel</a> instance pointing to this <a
                      href="QuerySet.html">QuerySet</a>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>_parent_element</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      <a href="Element.html">Element</a> inside the _parent pointing to this <a
                      href="QuerySet.html">QuerySet</a>.
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>append_element</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      If something that can&#8217;t be converted to a @model instance is appended
                      to the <a href="QuerySet.html">QuerySet</a>, and append_element is set, the
                      appended value will be set on the element named append_element of a new
                      instance of @model, which will be appended instead. This is useful for
                      junction models, which function as both types. Example:
                      
                      <pre>
                         cat = Animal.new; tiger = Animal.new;
                         # Instead of doing
                         friend = Animal::Friend.new(:animal =&gt; cat, :other_animal =&gt; tiger)
                         cat.friends &lt;&lt; friend
                         # since the junction was created setting append_element = :other_animal, one can do
                         cat.friends &lt;&lt; lion
                      </pre>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>fetch_window</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      (Fixnum) How many objects to load at a time. If nil, all the objects
                      returned by the <a href="Query.html">Query</a> will be loaded.
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>keep_window</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      (Fixnum) How many objects to keep in memory when advancing the window. If
                      nil, all objects will be kept.
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>loaded</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      (bool) Wether the <a href="QuerySet.html">QuerySet</a> has been loaded
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>loaded_elements</td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      An Hash of autoloaded elements.
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>model</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      The <a href="BaseModel.html">BaseModel</a>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>objects</td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      The actual fetched objects.
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>query</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      The <a href="Query.html">Query</a>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>raw_data</td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      Raw data returned by the mapper, if requested.
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>total_rows</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      Total number of objects present in the <a href="Storage.html">Storage</a>
                      for the <a href="Query.html">Query</a>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='public-class method' id='method-M000442'>
                <a name='M000442'>      </a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(model, query_or_val=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  The first argument must be a <a href="BaseModel.html">BaseModel</a>
                  subclass. The second argument may be a <a href="Query.html">Query</a>, or
                  data that will be passed to <a href="QuerySet.html#M000450">set_data</a>.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000442-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000442-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 59</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">model</span>, <span class="ruby-identifier">query_or_val</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;            <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">query_or_val</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Query</span>))&#x000A;                 <span class="ruby-identifier">query</span> = <span class="ruby-identifier">query_or_val</span> &#x000A;            <span class="ruby-keyword kw">else</span>&#x000A;                <span class="ruby-identifier">data</span> = <span class="ruby-identifier">query_or_val</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-ivar">@query</span> = <span class="ruby-identifier">query</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>&#x000A;            <span class="ruby-ivar">@model</span> = <span class="ruby-identifier">model</span>&#x000A;            <span class="ruby-ivar">@objects</span> = []&#x000A;            <span class="ruby-ivar">@raw_data</span> = []&#x000A;            <span class="ruby-ivar">@_parent</span> = <span class="ruby-keyword kw">nil</span>&#x000A;            <span class="ruby-ivar">@_parent_element</span> = <span class="ruby-keyword kw">nil</span>&#x000A;            <span class="ruby-ivar">@index_lookup</span> = {}&#x000A;            <span class="ruby-ivar">@total_rows</span> = <span class="ruby-keyword kw">nil</span>&#x000A;            <span class="ruby-ivar">@fetch_window</span> = <span class="ruby-keyword kw">nil</span>&#x000A;            <span class="ruby-ivar">@window_current_start</span> = <span class="ruby-keyword kw">nil</span>&#x000A;            <span class="ruby-ivar">@keep_window</span> = <span class="ruby-value">100</span>&#x000A;            <span class="ruby-ivar">@autoload</span> = <span class="ruby-identifier">query_or_val</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Query</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>&#x000A;            <span class="ruby-ivar">@identity_mapper</span> = <span class="ruby-keyword kw">nil</span>&#x000A;            <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword kw">false</span>&#x000A;            <span class="ruby-ivar">@loaded_elements</span> = {}&#x000A;            <span class="ruby-ivar">@fixed</span> = {}&#x000A;            <span class="ruby-ivar">@append_element</span> = <span class="ruby-keyword kw">nil</span>&#x000A;            <span class="ruby-ivar">@loadable</span> = <span class="ruby-keyword kw">true</span>&#x000A;            <span class="ruby-identifier">set_data</span>(<span class="ruby-identifier">data</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>&#x000A;            <span class="ruby-keyword kw">self</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-class method' id='method-M000441'>
                <a name='M000441'>      </a>
                <div class='synopsis'>
                  <span class='name'>static</span>
                  <span class='arguments'>(model, query_or_val=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Instantiates a non-autoloading queryset
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000441-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000441-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 51</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">static</span>(<span class="ruby-identifier">model</span>, <span class="ruby-identifier">query_or_val</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;            <span class="ruby-identifier">qs</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">model</span>, <span class="ruby-identifier">query_or_val</span>)&#x000A;            <span class="ruby-identifier">qs</span>.<span class="ruby-identifier">autoload</span> = <span class="ruby-keyword kw">false</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">qs</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000457'>
                <a name='M000457'>      </a>
                <div class='synopsis'>
                  <span class='name'>+</span>
                  <span class='arguments'>(other)</span>
                </div>
                <div class='description'>
                  <p>
                  Returns a new <a href="QuerySet.html">QuerySet</a> containing objects from
                  both this and the other.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000457-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000457-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 210</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-operator">+</span>(<span class="ruby-identifier">other</span>)&#x000A;            <span class="ruby-identifier">qs</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">clone</span>&#x000A;            <span class="ruby-identifier">other</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">qs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">qs</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000451'>
                <a name='M000451'>      </a>
                <div class='synopsis'>
                  <span class='name'>&lt;&lt;</span>
                  <span class='arguments'>(obj, raw=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Adds an object to the set. Also stores the raw data if it is passed as the
                  second parameter.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000451-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000451-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 140</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">raw</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">merge</span>(<span class="ruby-identifier">obj</span>) <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">QuerySet</span>)&#x000A;            <span class="ruby-keyword kw">unless</span> (<span class="ruby-identifier">obj</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-ivar">@model</span>))&#x000A;                <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">instantiate_object</span>(<span class="ruby-identifier">obj</span>)&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-ivar">@objects</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>&#x000A;            <span class="ruby-ivar">@fixed</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span>)&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-identifier">index_object</span>(<span class="ruby-identifier">obj</span>)&#x000A;            <span class="ruby-ivar">@raw_data</span>[<span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">raw</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">raw</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000452'>
                <a name='M000452'>      </a>
                <div class='synopsis'>
                  <span class='name'>[]</span>
                  <span class='arguments'>(index)</span>
                </div>
                <div class='description'>
                  <p>
                  Accesses an object. Data will be loaded according to fetch_window.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000452-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000452-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 155</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">index</span>)&#x000A;            <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">index</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Range</span>))&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">i</span>] }&#x000A;            <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">index</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>))&#x000A;                <span class="ruby-identifier">i</span>, <span class="ruby-identifier">rest</span> = <span class="ruby-identifier">index</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'.'</span>, <span class="ruby-value">2</span>)&#x000A;                <span class="ruby-identifier">i</span> = <span class="ruby-identifier">i</span>.<span class="ruby-identifier">to_i</span>&#x000A;                <span class="ruby-identifier">val</span> = <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">i</span>]&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-value str">''</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">val</span>&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">val</span>[<span class="ruby-identifier">rest</span>]&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-identifier">start</span> = <span class="ruby-identifier">start_for_index</span>(<span class="ruby-identifier">index</span>)&#x000A;            <span class="ruby-identifier">array_index</span> = (<span class="ruby-identifier">index</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">start</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>&#x000A;            <span class="ruby-identifier">load_to_index</span>(<span class="ruby-identifier">index</span>) <span class="ruby-keyword kw">unless</span> (<span class="ruby-ivar">@objects</span>[<span class="ruby-identifier">array_index</span>] <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@fetch_window</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@window_current_start</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">start</span>)) <span class="ruby-operator">||</span> <span class="ruby-identifier">loaded?</span>(<span class="ruby-identifier">index</span>) <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">autoload?</span>&#x000A;            <span class="ruby-identifier">val</span> = <span class="ruby-ivar">@objects</span>[<span class="ruby-identifier">array_index</span>]&#x000A;            <span class="ruby-identifier">val</span>.<span class="ruby-identifier">set_parent</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-keyword kw">nil</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">val</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000453'>
                <a name='M000453'>      </a>
                <div class='synopsis'>
                  <span class='name'>[]=</span>
                  <span class='arguments'>(index, val)</span>
                </div>
                <div class='description'>
                  <p>
                  Sets an object.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000453-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000453-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 174</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">val</span>)&#x000A;            <span class="ruby-comment cmt">#load_to_index(index) unless loaded?(index) || !autoload?</span>&#x000A;            <span class="ruby-identifier">val</span> = <span class="ruby-identifier">instantiate_object</span>(<span class="ruby-identifier">val</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-ivar">@model</span>)&#x000A;            <span class="ruby-ivar">@fixed</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">fkey</span>, <span class="ruby-identifier">fval</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">val</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">fkey</span>, <span class="ruby-identifier">fval</span>)&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-identifier">array_index</span> = <span class="ruby-identifier">index</span>&#x000A;            <span class="ruby-identifier">array_index</span> <span class="ruby-operator">-=</span> <span class="ruby-ivar">@window_current_start</span><span class="ruby-operator">-</span><span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@window_current_start</span>&#x000A;            <span class="ruby-ivar">@objects</span>[<span class="ruby-identifier">array_index</span>] = <span class="ruby-identifier">val</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000490'>
                <a name='M000490'>      </a>
                <div class='synopsis'>
                  <span class='name'>all_children</span>
                  <span class='arguments'>(path)</span>
                </div>
                <div class='description'>
                  <p>
                  Given a dotted path, will return an array of all objects reachable by that
                  path Example
                  </p>
                  <pre>objectset.all_children('friends.collegues.addresses.street_name')</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000490-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000490-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 550</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all_children</span>(<span class="ruby-identifier">path</span>)&#x000A;            <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">path</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)&#x000A;                <span class="ruby-identifier">children</span> = <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">all_children</span>(<span class="ruby-identifier">path</span>.<span class="ruby-identifier">clone</span>) }.<span class="ruby-identifier">flatten</span>&#x000A;            <span class="ruby-keyword kw">else</span>&#x000A;                <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@objects</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000445'>
                <a name='M000445'>      </a>
                <div class='synopsis'>
                  <span class='name'>autoload</span>
                  <span class='arguments'>(bool, traverse=true)</span>
                </div>
                <div class='description'>
                  <p>
                  Enables or disables autoload; if the second argument is true, will traverse
                  contained objects.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000445-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000445-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 100</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">autoload</span>(<span class="ruby-identifier">bool</span>, <span class="ruby-identifier">traverse</span>=<span class="ruby-keyword kw">true</span>)&#x000A;            <span class="ruby-ivar">@autoload</span> = <span class="ruby-identifier">bool</span>&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">autoload</span> = <span class="ruby-identifier">bool</span> } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">traverse</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000446'>
                <a name='M000446'>      </a>
                <div class='synopsis'>
                  <span class='name'>autoload=</span>
                  <span class='arguments'>(bool)</span>
                </div>
                <div class='description'>
                  <p>
                  Enables or disables autoload.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000446-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000446-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 106</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">autoload=</span>(<span class="ruby-identifier">bool</span>)&#x000A;            <span class="ruby-identifier">autoload</span>(<span class="ruby-identifier">bool</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000447'>
                <a name='M000447'>      </a>
                <div class='synopsis'>
                  <span class='name'>autoload?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000447-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000447-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 110</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">autoload?</span>&#x000A;            <span class="ruby-ivar">@autoload</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000498'>
                <a name='M000498'>      </a>
                <div class='synopsis'>
                  <span class='name'>clone</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Performs a deep copy
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000498-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000498-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 608</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">clone</span>&#x000A;            <span class="ruby-identifier">c</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">model</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">clone</span>)&#x000A;            <span class="ruby-identifier">c_objects</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">:@objects</span>)&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">c_objects</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">clone</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">c</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000461'>
                <a name='M000461'>      </a>
                <div class='synopsis'>
                  <span class='name'>current_length</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Current number of objects fetched.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000461-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000461-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 240</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">current_length</span>&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">length</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000484'>
                <a name='M000484'>      </a>
                <div class='synopsis'>
                  <span class='name'>cut</span>
                  <span class='arguments'>(*params)</span>
                </div>
                <div class='description'>
                  <p>
                  Returns an array with the results of calling <a
                  href="BaseModel.html">BaseModel</a>.cut on each object.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000484-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000484-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 471</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">cut</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">params</span>)&#x000A;            <span class="ruby-identifier">load</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">loaded?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">autoload?</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">cut</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">params</span>) }&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000456'>
                <a name='M000456'>      </a>
                <div class='synopsis'>
                  <span class='name'>delete_at</span>
                  <span class='arguments'>(index)</span>
                </div>
                <div class='description'>
                  <p>
                  Deletes object at the given index.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000456-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000456-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 205</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_at</span>(<span class="ruby-identifier">index</span>)&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-identifier">index</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000465'>
                <a name='M000465'>      </a>
                <div class='synopsis'>
                  <span class='name'>each</span>
                  <span class='arguments'>() {|obj| ...}</span>
                </div>
                <div class='description'>
                  <p>
                  Iterates on objects, loading when needed.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000465-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000465-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 296</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>&#x000A;            <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">each_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">obj</span> = <span class="ruby-ivar">@objects</span>[<span class="ruby-identifier">i</span>]&#x000A;                <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">set_parent</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-keyword kw">nil</span>)&#x000A;                <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">obj</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000464'>
                <a name='M000464'>      </a>
                <div class='synopsis'>
                  <span class='name'>each_current</span>
                  <span class='arguments'>() {|obj| ...}</span>
                </div>
                <div class='description'>
                  <p>
                  Iterates on currently loaded objects
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000464-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000464-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 291</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_current</span>&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">obj</span> }&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000467'>
                <a name='M000467'>      </a>
                <div class='synopsis'>
                  <span class='name'>each_current_index</span>
                  <span class='arguments'>() {|i| ...}</span>
                </div>
                <div class='description'>
                  <p>
                  Iterates on indexes without loading.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000467-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000467-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 317</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_current_index</span>&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">each_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@window_current_start</span><span class="ruby-operator">-</span><span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@window_current_start</span>&#x000A;                <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">i</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000466'>
                <a name='M000466'>      </a>
                <div class='synopsis'>
                  <span class='name'>each_index</span>
                  <span class='arguments'>() {|i| ...}</span>
                </div>
                <div class='description'>
                  <p>
                  Iterates yielding objects index. Will load when needed.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000466-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000466-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 305</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each_index</span>&#x000A;            <span class="ruby-ivar">@window_current_start</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-ivar">@fetch_window</span>)&#x000A;            <span class="ruby-keyword kw">while</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@fetch_window</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">has_more?</span>)&#x000A;                <span class="ruby-identifier">load_next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-operator">!</span><span class="ruby-identifier">autoload?</span> <span class="ruby-operator">||</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@fetch_window</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@loaded</span>)&#x000A;                <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">each_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>&#x000A;                    <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">i</span>&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;                <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">autoload?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@fetch_window</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000491'>
                <a name='M000491'>      </a>
                <div class='synopsis'>
                  <span class='name'>element_loaded</span>
                  <span class='arguments'>(element)</span>
                </div>
                <div class='description'>
                  <p>
                  Registers that the element has been loaded.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000491-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000491-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 559</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">element_loaded</span>(<span class="ruby-identifier">element</span>)&#x000A;            <span class="ruby-identifier">element</span> = <span class="ruby-identifier">element</span>.<span class="ruby-identifier">name</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">element</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Element</span>)&#x000A;            <span class="ruby-ivar">@loaded_elements</span>[<span class="ruby-identifier">element</span>] = <span class="ruby-keyword kw">true</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000492'>
                <a name='M000492'>      </a>
                <div class='synopsis'>
                  <span class='name'>element_loaded?</span>
                  <span class='arguments'>(element)</span>
                </div>
                <div class='description'>
                  <p>
                  Returns whether the element has been loaded from the <a
                  href="Storage.html">Storage</a>.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000492-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000492-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 565</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">element_loaded?</span>(<span class="ruby-identifier">element</span>)&#x000A;            <span class="ruby-identifier">element</span> = <span class="ruby-identifier">element</span>.<span class="ruby-identifier">name</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">element</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Element</span>)&#x000A;            <span class="ruby-ivar">@loaded_elements</span>[<span class="ruby-identifier">element</span>]&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000462'>
                <a name='M000462'>      </a>
                <div class='synopsis'>
                  <span class='name'>empty?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  True if no objects were fetched (yet).
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000462-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000462-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 245</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty?</span>&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">empty?</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000469'>
                <a name='M000469'>      </a>
                <div class='synopsis'>
                  <span class='name'>find</span>
                  <span class='arguments'>(params)</span>
                </div>
                <div class='description'>
                  <p>
                  Searchs the index for objects matching the given params.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000469-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000469-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 331</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>)&#x000A;            <span class="ruby-identifier">sorted_keys</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_s</span>}.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">to_sym</span>}&#x000A;            <span class="ruby-identifier">index</span> = <span class="ruby-identifier">sorted_keys</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">','</span>)&#x000A;            <span class="ruby-identifier">search_key</span> = <span class="ruby-identifier">sorted_keys</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">search_key</span>(<span class="ruby-identifier">params</span>, <span class="ruby-identifier">key</span>) }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">','</span>)&#x000A;            <span class="ruby-comment cmt"># TODO: implement find without index</span>&#x000A;            <span class="ruby-identifier">raise</span> <span class="ruby-constant">UnimplementedError</span>, <span class="ruby-value str">&quot;find without an index is not yet implemented&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@index_lookup</span>[<span class="ruby-identifier">index</span>]&#x000A;            <span class="ruby-identifier">result</span> = <span class="ruby-ivar">@index_lookup</span>[<span class="ruby-identifier">index</span>][<span class="ruby-identifier">search_key</span>]&#x000A;            <span class="ruby-comment cmt">#result = QuerySet.new(result) if (result)</span>&#x000A;            <span class="ruby-comment cmt">#@objects = result</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-constant">QuerySet</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@model</span>, <span class="ruby-identifier">result</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000444'>
                <a name='M000444'>      </a>
                <div class='synopsis'>
                  <span class='name'>fixed</span>
                  <span class='arguments'>(name, value)</span>
                </div>
                <div class='description'>
                  <p>
                  Sets a fixed value: it will be applied to every object.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000444-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000444-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 94</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fixed</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)&#x000A;            <span class="ruby-ivar">@fixed</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">value</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000459'>
                <a name='M000459'>      </a>
                <div class='synopsis'>
                  <span class='name'>has_more?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  True if the query had a limit, and more results can be fetched.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000459-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000459-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 227</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">has_more?</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">autoload?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@loaded</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">query</span>.<span class="ruby-identifier">limit</span>&#x000A;            <span class="ruby-identifier">pos</span> = <span class="ruby-identifier">query</span>.<span class="ruby-identifier">offset</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">length</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">total_rows</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000493'>
                <a name='M000493'>      </a>
                <div class='synopsis'>
                  <span class='name'>identity_mapper</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns the <a href="QuerySet.html">QuerySet</a> <a
                  href="IdentityMapper.html">IdentityMapper</a> instance
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000493-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000493-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 571</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identity_mapper</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Spider</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span>.<span class="ruby-identifier">identity_mapper</span> <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Spider</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span>.<span class="ruby-identifier">identity_mapper</span>&#x000A;            <span class="ruby-ivar">@identity_mapper</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">IdentityMapper</span>.<span class="ruby-identifier">new</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000494'>
                <a name='M000494'>      </a>
                <div class='synopsis'>
                  <span class='name'>identity_mapper=</span>
                  <span class='arguments'>(im)</span>
                </div>
                <div class='description'>
                  <p>
                  Assigns an <a href="IdentityMapper.html">IdentityMapper</a>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000494-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000494-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 577</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">identity_mapper=</span>(<span class="ruby-identifier">im</span>)&#x000A;            <span class="ruby-ivar">@identity_mapper</span> = <span class="ruby-identifier">im</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000463'>
                <a name='M000463'>      </a>
                <div class='synopsis'>
                  <span class='name'>index_by</span>
                  <span class='arguments'>(*elements)</span>
                </div>
                <div class='description'>
                  <p>
                  Index objects by some elements.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000463-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000463-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 250</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">index_by</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">elements</span>)&#x000A;            <span class="ruby-identifier">names</span> = <span class="ruby-identifier">elements</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">el</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Spider</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span><span class="ruby-operator">::</span><span class="ruby-constant">Element</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">el</span>.<span class="ruby-identifier">to_s</span> }&#x000A;            <span class="ruby-identifier">index_name</span> = <span class="ruby-identifier">names</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">','</span>)&#x000A;            <span class="ruby-ivar">@index_lookup</span>[<span class="ruby-identifier">index_name</span>] = {}&#x000A;            <span class="ruby-identifier">reindex</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000478'>
                <a name='M000478'>      </a>
                <div class='synopsis'>
                  <span class='name'>insert</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Calls <a href="BaseModel.html">BaseModel</a>.insert on each object in the
                  <a href="QuerySet.html">QuerySet</a>.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000478-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000478-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 424</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">insert</span>&#x000A;            <span class="ruby-identifier">no_autoload</span>(<span class="ruby-keyword kw">false</span>){ <span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">insert</span> } }&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000482'>
                <a name='M000482'>      </a>
                <div class='synopsis'>
                  <span class='name'>inspect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000482-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000482-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 457</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{self.class.name}:\n@model=#{@model}, @query=#{query.inspect}, @objects=#{@objects.inspect}&quot;</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000481'>
                <a name='M000481'>      </a>
                <div class='synopsis'>
                  <span class='name'>instantiate_object</span>
                  <span class='arguments'>(val=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Returns a new instance of @model from val.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000481-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000481-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 442</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">instantiate_object</span>(<span class="ruby-identifier">val</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;            <span class="ruby-keyword kw">if</span> (<span class="ruby-ivar">@append_element</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-ivar">@model</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">val</span>[<span class="ruby-ivar">@append_element</span>]))&#x000A;                <span class="ruby-identifier">val</span> = <span class="ruby-ivar">@model</span>.<span class="ruby-identifier">elements</span>[<span class="ruby-ivar">@append_element</span>].<span class="ruby-identifier">type</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">val</span>) <span class="ruby-keyword kw">unless</span> (<span class="ruby-identifier">val</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">BaseModel</span>))&#x000A;                <span class="ruby-identifier">val</span> = {<span class="ruby-ivar">@append_element</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">val</span>}&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;                &#x000A;            <span class="ruby-identifier">obj</span> = <span class="ruby-ivar">@model</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">val</span>)&#x000A;            <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">identity_mapper</span> = <span class="ruby-ivar">@identity_mapper</span>&#x000A;            <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">autoload</span> = <span class="ruby-identifier">autoload?</span>&#x000A;            <span class="ruby-ivar">@fixed</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">fval</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">fval</span>)&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">obj</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000455'>
                <a name='M000455'>      </a>
                <div class='synopsis'>
                  <span class='name'>last</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns the last object.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000455-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000455-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 199</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">last</span>&#x000A;            <span class="ruby-identifier">load</span> <span class="ruby-keyword kw">unless</span> (<span class="ruby-ivar">@loaded</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">autoload?</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">loaded?</span>(<span class="ruby-identifier">total_rows</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>)&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">last</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000458'>
                <a name='M000458'>      </a>
                <div class='synopsis'>
                  <span class='name'>length</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Number of objects fetched. Will call load if not loaded yet. Note: this is
                  not the total number of objects corresponding to the <a
                  href="Query.html">Query</a>; it may be equal to the fetch_window, or to the
                  @query.limit.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000458-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000458-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 221</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">length</span>&#x000A;            <span class="ruby-identifier">load</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@loaded</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">autoload?</span>&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">length</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000496'>
                <a name='M000496'>      </a>
                <div class='synopsis'>
                  <span class='name'>limit</span>
                  <span class='arguments'>(n)</span>
                </div>
                <div class='description'>
                  <p>
                  Calls <a href="Query.html">Query</a>.limit
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000496-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000496-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 592</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">limit</span>(<span class="ruby-identifier">n</span>)&#x000A;            <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">limit</span> = <span class="ruby-identifier">n</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000472'>
                <a name='M000472'>      </a>
                <div class='synopsis'>
                  <span class='name'>load</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Executes the query and fetches the objects; (the next batch if a
                  fetch_window is set).
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000472-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000472-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 362</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">loadable?</span>&#x000A;            <span class="ruby-ivar">@objects</span> = []&#x000A;            <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword kw">false</span>&#x000A;            <span class="ruby-ivar">@loaded_elements</span> = {}&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">load_next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@fetch_window</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@query</span>.<span class="ruby-identifier">offset</span>&#x000A;            <span class="ruby-identifier">mapper</span>.<span class="ruby-identifier">find</span>(<span class="ruby-ivar">@query</span>.<span class="ruby-identifier">clone</span>, <span class="ruby-keyword kw">self</span>)&#x000A;            <span class="ruby-ivar">@loaded</span> = <span class="ruby-keyword kw">true</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000474'>
                <a name='M000474'>      </a>
                <div class='synopsis'>
                  <span class='name'>load_next</span>
                  <span class='arguments'>(page=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Loads the next batch of objects.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000474-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000474-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 388</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_next</span>(<span class="ruby-identifier">page</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;            <span class="ruby-keyword kw">if</span> (<span class="ruby-ivar">@fetch_window</span>)&#x000A;                <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">limit</span> = <span class="ruby-ivar">@fetch_window</span>&#x000A;                <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">page</span>)&#x000A;                    <span class="ruby-ivar">@window_current_start</span> = (<span class="ruby-identifier">page</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>) <span class="ruby-operator">*</span> <span class="ruby-ivar">@fetch_window</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>&#x000A;                <span class="ruby-keyword kw">else</span>&#x000A;                    <span class="ruby-keyword kw">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@window_current_start</span>)&#x000A;                        <span class="ruby-ivar">@window_current_start</span> = <span class="ruby-value">1</span>&#x000A;                    <span class="ruby-keyword kw">else</span>&#x000A;                        <span class="ruby-ivar">@window_current_start</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@fetch_window</span>&#x000A;                    <span class="ruby-keyword kw">end</span>&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;                <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">offset</span> = <span class="ruby-ivar">@window_current_start</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">load</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000473'>
                <a name='M000473'>      </a>
                <div class='synopsis'>
                  <span class='name'>load_to_index</span>
                  <span class='arguments'>(i)</span>
                </div>
                <div class='description'>
                  <p>
                  Loads objects up to index i
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000473-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000473-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 381</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_to_index</span>(<span class="ruby-identifier">i</span>)&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">load</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@fetch_window</span>&#x000A;            <span class="ruby-identifier">page</span> = <span class="ruby-identifier">i</span> <span class="ruby-operator">/</span> <span class="ruby-ivar">@fetch_window</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>&#x000A;            <span class="ruby-identifier">load_next</span>(<span class="ruby-identifier">page</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000476'>
                <a name='M000476'>      </a>
                <div class='synopsis'>
                  <span class='name'>loadable?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000476-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000476-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 414</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">loadable?</span>&#x000A;            <span class="ruby-ivar">@loadable</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000475'>
                <a name='M000475'>      </a>
                <div class='synopsis'>
                  <span class='name'>loaded?</span>
                  <span class='arguments'>(index=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  If a Fixnum is passed, will tell if the given index is loaded. With no
                  argument, will tell if the <a href="QuerySet.html">QuerySet</a> is loaded
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000475-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000475-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 407</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">loaded?</span>(<span class="ruby-identifier">index</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@loaded</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@loaded</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">index</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@fetch_window</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@window_current_start</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@window_current_start</span><span class="ruby-operator">-</span><span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@window_current_start</span><span class="ruby-operator">+</span><span class="ruby-ivar">@fetch_window</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000443'>
                <a name='M000443'>      </a>
                <div class='synopsis'>
                  <span class='name'>mapper</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  <a href="../Model.html">Model</a> mapper.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000443-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000443-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 89</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">mapper</span>&#x000A;            <span class="ruby-ivar">@model</span>.<span class="ruby-identifier">mapper</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000468'>
                <a name='M000468'>      </a>
                <div class='synopsis'>
                  <span class='name'>merge</span>
                  <span class='arguments'>(query_set)</span>
                </div>
                <div class='description'>
                  <p>
                  Merges the content of another <a href="QuerySet.html">QuerySet</a>.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000468-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000468-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 325</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge</span>(<span class="ruby-identifier">query_set</span>)&#x000A;            <span class="ruby-ivar">@objects</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">query_set</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">:&quot;@objects&quot;</span>)&#x000A;            <span class="ruby-identifier">reindex</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000489'>
                <a name='M000489'>      </a>
                <div class='synopsis'>
                  <span class='name'>method_missing</span>
                  <span class='arguments'>(method, *args, &amp;proc)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000489-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000489-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 543</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)     &#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000449'>
                <a name='M000449'>      </a>
                <div class='synopsis'>
                  <span class='name'>no_autoload</span>
                  <span class='arguments'>(traverse=true) {|| ...}</span>
                </div>
                <div class='description'>
                  <p>
                  Disables autoload. If a block is given, the current autoload value will be
                  restored after yielding.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000449-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000449-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 121</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">no_autoload</span>(<span class="ruby-identifier">traverse</span>=<span class="ruby-keyword kw">true</span>)&#x000A;            <span class="ruby-identifier">prev_autoload</span> = <span class="ruby-identifier">autoload?</span>&#x000A;            <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">autoload</span>(<span class="ruby-keyword kw">false</span>, <span class="ruby-identifier">traverse</span>)&#x000A;            <span class="ruby-keyword kw">yield</span>&#x000A;            <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">autoload</span>(<span class="ruby-identifier">prev_autoload</span>, <span class="ruby-identifier">traverse</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000497'>
                <a name='M000497'>      </a>
                <div class='synopsis'>
                  <span class='name'>offset</span>
                  <span class='arguments'>(n)</span>
                </div>
                <div class='description'>
                  <p>
                  Calls <a href="Query.html">Query</a>.offset
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000497-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000497-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 598</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">offset</span>(<span class="ruby-identifier">n</span>)&#x000A;            <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">offset</span> = <span class="ruby-identifier">n</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000470'>
                <a name='M000470'>      </a>
                <div class='synopsis'>
                  <span class='name'>order_by</span>
                  <span class='arguments'>(*elements)</span>
                </div>
                <div class='description'>
                  <p>
                  Calls <a href="Query.html#M000371">Query.order_by</a>
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000470-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000470-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 344</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">order_by</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">elements</span>)&#x000A;            <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">order_by</span> <span class="ruby-operator">*</span><span class="ruby-identifier">elements</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000477'>
                <a name='M000477'>      </a>
                <div class='synopsis'>
                  <span class='name'>save</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Saves each object in the <a href="QuerySet.html">QuerySet</a>.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000477-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000477-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 419</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save</span>&#x000A;            <span class="ruby-identifier">no_autoload</span>(<span class="ruby-keyword kw">false</span>){ <span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">save</span> } }&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000480'>
                <a name='M000480'>      </a>
                <div class='synopsis'>
                  <span class='name'>save_all</span>
                  <span class='arguments'>(params={})</span>
                </div>
                <div class='description'>
                  <p>
                  Calls <a href="BaseModel.html">BaseModel</a>.<a
                  href="QuerySet.html#M000480">save_all</a> on each object in the <a
                  href="QuerySet.html">QuerySet</a>.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000480-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000480-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 434</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save_all</span>(<span class="ruby-identifier">params</span>={})&#x000A;            <span class="ruby-ivar">@objects</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> &#x000A;<span class="ruby-comment cmt">#                next if (unit_of_work &amp;&amp; !unit_of_work.save?(obj))</span>&#x000A;                <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">save_all</span>(<span class="ruby-identifier">params</span>)&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000471'>
                <a name='M000471'>      </a>
                <div class='synopsis'>
                  <span class='name'>set</span>
                  <span class='arguments'>(element, value)</span>
                </div>
                <div class='description'>
                  <p>
                  Sets the value of an element on all currently loaded objects.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000471-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000471-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 350</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set</span>(<span class="ruby-identifier">element</span>, <span class="ruby-identifier">value</span>)&#x000A;            <span class="ruby-identifier">element_name</span> = <span class="ruby-identifier">element</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Element</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">element</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">element</span>&#x000A;            <span class="ruby-identifier">fixed</span>(<span class="ruby-identifier">element_name</span>, <span class="ruby-identifier">value</span>)&#x000A;<span class="ruby-comment cmt">#            @query.condition.set(element, '=', value)</span>&#x000A;            <span class="ruby-identifier">no_autoload</span>(<span class="ruby-keyword kw">false</span>) <span class="ruby-keyword kw">do</span>&#x000A;                <span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>&#x000A;                    <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">set</span>(<span class="ruby-identifier">element_name</span>, <span class="ruby-identifier">value</span>)&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000450'>
                <a name='M000450'>      </a>
                <div class='synopsis'>
                  <span class='name'>set_data</span>
                  <span class='arguments'>(data)</span>
                </div>
                <div class='description'>
                  <p>
                  Adds objects to the <a href="QuerySet.html">QuerySet</a>. The argument must
                  be an Enumerable (and should contain <a href="BaseModel.html">BaseModel</a>
                  instances).
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000450-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000450-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 129</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_data</span>(<span class="ruby-identifier">data</span>)&#x000A;            <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">data</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Enumerable</span>))&#x000A;                <span class="ruby-identifier">data</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span><span class="ruby-operator">|</span>&#x000A;                    <span class="ruby-keyword kw">self</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">val</span>&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">else</span>&#x000A;                <span class="ruby-keyword kw">self</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">data</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000448'>
                <a name='M000448'>      </a>
                <div class='synopsis'>
                  <span class='name'>set_parent</span>
                  <span class='arguments'>(obj, element)</span>
                </div>
                <div class='description'>
                  <p>
                  Sets containing model and element.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000448-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000448-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 115</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_parent</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">element</span>)&#x000A;            <span class="ruby-ivar">@_parent</span> = <span class="ruby-identifier">obj</span>&#x000A;            <span class="ruby-ivar">@_parent_element</span> = <span class="ruby-identifier">element</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000486'>
                <a name='M000486'>      </a>
                <div class='synopsis'>
                  <span class='name'>table</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Prints an ASCII table
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000486-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000486-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 482</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">table</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">print</span>(<span class="ruby-value str">&quot;Empty\n&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>&#x000A;            <span class="ruby-identifier">columns</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'COLUMNS'</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">||</span> <span class="ruby-value">80</span>&#x000A;            <span class="ruby-identifier">a</span> = <span class="ruby-identifier">to_flat_array</span>&#x000A;            <span class="ruby-identifier">m_sizes</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">0</span>) <span class="ruby-comment cmt"># one separator column</span>&#x000A;            <span class="ruby-identifier">a</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">row</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>&#x000A;                    <span class="ruby-identifier">m_sizes</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">val</span>.<span class="ruby-identifier">length</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">m_sizes</span>[<span class="ruby-identifier">key</span>]&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-identifier">elements</span> = <span class="ruby-ivar">@model</span>.<span class="ruby-identifier">elements_array</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span> <span class="ruby-identifier">m_sizes</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>}&#x000A;            <span class="ruby-identifier">elements</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">m_sizes</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">el</span>.<span class="ruby-identifier">label</span>.<span class="ruby-identifier">length</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">el</span>.<span class="ruby-identifier">label</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">m_sizes</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>] <span class="ruby-operator">+</span> <span class="ruby-value">1</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-identifier">reduce</span> = <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">to_f</span><span class="ruby-operator">/</span>(<span class="ruby-identifier">m_sizes</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">inject</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">sum</span>, <span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sum</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">s</span> })&#x000A;            <span class="ruby-identifier">sizes</span> = {}&#x000A;            <span class="ruby-identifier">m_sizes</span>.<span class="ruby-identifier">each_key</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sizes</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">m_sizes</span>[<span class="ruby-identifier">k</span>] <span class="ruby-operator">*</span> <span class="ruby-identifier">reduce</span> }&#x000A;            <span class="ruby-identifier">avail</span> = <span class="ruby-identifier">columns</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">sizes</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">inject</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">sum</span>, <span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sum</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">s</span> }&#x000A;            <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">avail</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">truncated</span> = <span class="ruby-identifier">sizes</span>.<span class="ruby-identifier">reject</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">m_sizes</span>[<span class="ruby-identifier">k</span>] }).<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>&#x000A;                <span class="ruby-identifier">truncated</span>.<span class="ruby-identifier">each_key</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>&#x000A;                    <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">avail</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>&#x000A;                    <span class="ruby-identifier">sizes</span>[<span class="ruby-identifier">k</span>] <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>; <span class="ruby-identifier">avail</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;            <span class="ruby-value">1</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-identifier">columns</span>) { <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;-&quot;</span> }&#x000A;            <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;            <span class="ruby-identifier">elements</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;|&quot;</span>&#x000A;                <span class="ruby-identifier">print</span> <span class="ruby-identifier">el</span>.<span class="ruby-identifier">label</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-identifier">sizes</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>]].<span class="ruby-identifier">ljust</span>(<span class="ruby-identifier">sizes</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>])&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;            <span class="ruby-value">1</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-identifier">columns</span>) { <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;-&quot;</span> }&#x000A;            <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;            <span class="ruby-identifier">a</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">elements</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>&#x000A;                    <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;|&quot;</span>&#x000A;                    <span class="ruby-identifier">print</span> <span class="ruby-identifier">row</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>][<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-identifier">sizes</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>]].<span class="ruby-identifier">ljust</span>(<span class="ruby-identifier">sizes</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>])&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;                <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-value">1</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-identifier">columns</span>) { <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;-&quot;</span> }&#x000A;            <span class="ruby-identifier">print</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;            &#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000487'>
                <a name='M000487'>      </a>
                <div class='synopsis'>
                  <span class='name'>to_flat_array</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns an array of Hashes, with each value of the object is converted to
                  string.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000487-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000487-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 529</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_flat_array</span>&#x000A;            <span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-identifier">h</span> = {}&#x000A;                <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">each_element</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>&#x000A;                    <span class="ruby-identifier">h</span>[<span class="ruby-identifier">el</span>.<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">element_has_value?</span>(<span class="ruby-identifier">el</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">el</span>).<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-value str">''</span>&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;                <span class="ruby-identifier">h</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000485'>
                <a name='M000485'>      </a>
                <div class='synopsis'>
                  <span class='name'>to_hash_array</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Returns an array with the results of calling <a
                  href="BaseModel.html">BaseModel</a>.<a
                  href="QuerySet.html#M000485">to_hash_array</a> on each object.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000485-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000485-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 477</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_hash_array</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_hash</span> }&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000483'>
                <a name='M000483'>      </a>
                <div class='synopsis'>
                  <span class='name'>to_json</span>
                  <span class='arguments'>(state=nil, &amp;proc)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000483-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000483-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 461</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_json</span>(<span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)&#x000A;            <span class="ruby-identifier">load</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">loaded?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">autoload?</span>&#x000A;            <span class="ruby-identifier">res</span> =  <span class="ruby-value str">&quot;[&quot;</span> <span class="ruby-operator">+</span>&#x000A;                <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">to_json</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>) }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">','</span>) <span class="ruby-operator">+</span>&#x000A;                <span class="ruby-value str">&quot;]&quot;</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">res</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000488'>
                <a name='M000488'>      </a>
                <div class='synopsis'>
                  <span class='name'>to_s</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000488-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000488-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 539</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>&#x000A;            <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">o</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">to_s</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000460'>
                <a name='M000460'>      </a>
                <div class='synopsis'>
                  <span class='name'>total_rows</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Total number of objects that would be returned had the <a
                  href="Query.html">Query</a> no limit.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000460-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000460-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 235</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">total_rows</span>&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@total_rows</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@total_rows</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@model</span>.<span class="ruby-identifier">mapper</span>.<span class="ruby-identifier">count</span>(<span class="ruby-ivar">@query</span>.<span class="ruby-identifier">condition</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000479'>
                <a name='M000479'>      </a>
                <div class='synopsis'>
                  <span class='name'>update</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Calls <a href="BaseModel.html">BaseModel</a>.update on each object in the
                  <a href="QuerySet.html">QuerySet</a>.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000479-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000479-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 429</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update</span>&#x000A;            <span class="ruby-identifier">no_autoload</span>(<span class="ruby-keyword kw">false</span>){ <span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">update</span> } }&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000454'>
                <a name='M000454'>      </a>
                <div class='synopsis'>
                  <span class='name'>update_loaded_elements</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  Checks contained objects&#8217; loaded elements.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000454-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000454-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 186</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">update_loaded_elements</span>&#x000A;            <span class="ruby-identifier">f_loaded</span> = {}&#x000A;            <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">each_current</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>&#x000A;                <span class="ruby-ivar">@loaded_elements</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">el</span><span class="ruby-operator">|</span>&#x000A;                    <span class="ruby-identifier">f_loaded</span>[<span class="ruby-identifier">el</span>] = <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">loaded_elements</span>[<span class="ruby-identifier">el</span>]&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-ivar">@loaded_elements</span> = {}&#x000A;            <span class="ruby-ivar">@loaded_elements</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-ivar">@objects</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">loaded_elements</span>)&#x000A;            <span class="ruby-ivar">@loaded_elements</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">f_loaded</span>)&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000495'>
                <a name='M000495'>      </a>
                <div class='synopsis'>
                  <span class='name'>where</span>
                  <span class='arguments'>(*params, &amp;proc)</span>
                </div>
                <div class='description'>
                  <p>
                  Calls <a href="Query.html">Query</a>.where
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000495-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000495-source'><span class="ruby-comment cmt"># File lib/spiderfw/model/query_set.rb, line 586</span>&#x000A;        <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">where</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">params</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)&#x000A;            <span class="ruby-ivar">@query</span>.<span class="ruby-identifier">where</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">params</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)&#x000A;            <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>&#x000A;        <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
