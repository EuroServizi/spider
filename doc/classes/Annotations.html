<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Annotations [Spider documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Module</span>
          Annotations
        </h1>
        <ol class='paths'>
          <li>
            <a href="../files/lib/spiderfw/utils/annotations_rb.html">lib/spiderfw/utils/annotations.rb</a>
            (<a href="http://github.com/me/spider/tree/master/lib/spiderfw/utils/annotations.rb">view online</a>)
          </li>
        </ol>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            Module to allow annotations on methods. When included into a <a
            href="Class.html">Class</a> or Module, will make the <a
            href="Annotations/ClassMethods.html#M000025">Annotations::ClassMethods.__</a>
            and Annotations::ClassMethods.___ methods available. These can be used
            before a method to add annotations. The including class can also use <a
            href="Annotations/ClassMethods.html#M000028">Annotations::ClassMethods.define_annotation</a>
            to define code that will be executed when an annotation is encountered.
            </p>
            <p>
            Example:
            </p>
            <pre>class A&#x000A;  include Annotations&#x000A;&#x000A;  def self.cool_methods; @cool_methods ||= []; end&#x000A;&#x000A;  define_annotation :method_rating do |klass, method, args|&#x000A;    klass.cool_methods &lt;&lt; method if args[0] == :cool&#x000A;  end&#x000A;&#x000A;  __.is_first_method&#x000A;  def method1&#x000A;  end&#x000A;&#x000A;___.is_other_method&#x000A;  def method2&#x000A;  end&#x000A;&#x000A;  __.method_rating :cool&#x000A;  def method3&#x000A;  end&#x000A;&#x000A;end&#x000A;&#x000A;p A.annotations[:method1] =&gt; {:is_first_method =&gt; true}&#x000A;p A.annotations[:method3] =&gt; {:is_other_method =&gt; true, :method_rating =&gt; :cool}&#x000A;p A.cool_methods =&gt; [:method3]</pre>
            <p>
            <b>Warning</b>: annotations are <b>not</b> thread safe; if more than one
            file is being loaded at the same time for the same Module, annotations may
            end up wrong. You should ensure that all code using annotations is loaded
            in a single thread (this is usually a good idea anyway).
            </p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000022">included</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000023">included</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Module <a href="Annotations/ClassMethods.html" class="link">Annotations::ClassMethods</a><br />
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='public-class method' id='method-M000022'>
                <a name='M000022'>      </a>
                <div class='synopsis'>
                  <span class='name'>included</span>
                  <span class='arguments'>(klass)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000022-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000022-source'><span class="ruby-comment cmt"># File lib/spiderfw/utils/annotations.rb, line 41</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">included</span>(<span class="ruby-identifier">klass</span>)&#x000A;        <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">ClassMethods</span>)&#x000A;        <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">klass</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Module</span>))&#x000A;            <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">instance_eval</span> <span class="ruby-keyword kw">do</span>&#x000A;                <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">included</span>(<span class="ruby-identifier">klass</span>)&#x000A;                    <span class="ruby-keyword kw">if</span> (<span class="ruby-ivar">@defined_annotations</span>)&#x000A;                        <span class="ruby-ivar">@defined_annotations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">proc</span><span class="ruby-operator">|</span>&#x000A;                            <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">define_annotation</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)&#x000A;                        <span class="ruby-keyword kw">end</span>&#x000A;                    <span class="ruby-keyword kw">end</span>&#x000A;                    <span class="ruby-ivar">@annotations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span>, <span class="ruby-identifier">vals</span><span class="ruby-operator">|</span>&#x000A;                        <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">args</span><span class="ruby-operator">|</span>&#x000A;                            <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">annotate</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">k</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;                        <span class="ruby-keyword kw">end</span>&#x000A;                    <span class="ruby-keyword kw">end</span>&#x000A;                    <span class="ruby-keyword kw">super</span>&#x000A;                <span class="ruby-keyword kw">end</span>&#x000A;            <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-keyword kw">super</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000023'>
                <a name='M000023'>      </a>
                <div class='synopsis'>
                  <span class='name'>included</span>
                  <span class='arguments'>(klass)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000023-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000023-source'><span class="ruby-comment cmt"># File lib/spiderfw/utils/annotations.rb, line 45</span>&#x000A;                <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">included</span>(<span class="ruby-identifier">klass</span>)&#x000A;                    <span class="ruby-keyword kw">if</span> (<span class="ruby-ivar">@defined_annotations</span>)&#x000A;                        <span class="ruby-ivar">@defined_annotations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">proc</span><span class="ruby-operator">|</span>&#x000A;                            <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">define_annotation</span>(<span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">proc</span>)&#x000A;                        <span class="ruby-keyword kw">end</span>&#x000A;                    <span class="ruby-keyword kw">end</span>&#x000A;                    <span class="ruby-ivar">@annotations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span>, <span class="ruby-identifier">vals</span><span class="ruby-operator">|</span>&#x000A;                        <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">args</span><span class="ruby-operator">|</span>&#x000A;                            <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">annotate</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">k</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;                        <span class="ruby-keyword kw">end</span>&#x000A;                    <span class="ruby-keyword kw">end</span>&#x000A;                    <span class="ruby-keyword kw">super</span>&#x000A;                <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
